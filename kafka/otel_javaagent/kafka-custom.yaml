rules:

  # Producer throttle time (broker)
  - bean: "kafka.network:type=RequestChannel,name=ThrottleTimeMs,request=Produce"
    mapping:
      Value:
        metric: kafka_producer_throttle_time_ms
        type: counter
        desc: "Producer throttle time in ms"
        unit: "ms"

  # Consumer fetch throttle time (broker)
  - bean: "kafka.network:type=RequestChannel,name=ThrottleTimeMs,request=Fetch"
    mapping:
      Value:
        metric: kafka_fetch_throttle_time_ms
        type: counter
        desc: "Consumer fetch throttle time in ms"
        unit: "ms"

  # Byte rate per client-id (using ClientQuotaManager)
  - bean: "kafka.server:type=ClientQuotaManager,name=ThrottleTimeMs,client-id=*"
    metricAttribute:
      client_id: param(client-id)
    mapping:
      Count:
        metric: kafka_client_quota_throttle_time_ms_total
        type: counter
        desc: "Total throttle time applied to this client"
        unit: "ms"
